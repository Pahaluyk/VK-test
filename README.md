VK-test/
├── README.md              # Документация проекта
├── OpenCV.py              # OpenCV детектор заставок
├── DINO.py                # DINO ViT детектор заставок
├── labels_test.json       # Разметка тестового набора (45 видео)
├── labels_train.json      # Разметка обучающего набора (80 видео)
├── results.json           # Результаты OpenCV детектора
├── results_dino.json      # Результаты DINO детектора
└── best_classifier_dino.pth  # Веса обученной модели DINO



#  Детектор заставок видео

Автоматическое обнаружение временных интервалов заставок в телевизионных сериалах.

## Результаты

| Подход | IoU | Время |
|--------|-----|-----|
| **OpenCV** | 0.33 | очень быстро |
| **DINO ViT** | 0.31 | медленно и требует обучения|

##  Использование

# Как работает OpenCV детектор
1. Извлечение признаков

Анализирует каждые 0.5 секунды в первых 5 минутах видео
Извлекает 17 визуальных признаков: цвет, яркость, контрастность, границы, гистограммы
Уменьшает кадры до 64x64 пикселей для ускорения

2. Поиск стабильных участков

Перебирает все возможные интервалы длиной 8-30 секунд
Вычисляет стабильность каждого признака (низкая вариация = высокая стабильность)
Заставки обычно визуально стабильнее основного контента

3. Система скоринга

Стабильность: основной фактор (чем стабильнее, тем лучше)
Позиция: бонус за расположение в начале видео
Длина: бонус за близость к типичным 12 секундам
Штрафы: за слишком короткие или длинные интервалы

4. Выбор лучшего кандидата

Сортирует все кандидаты по итоговому скору
Применяет пороги качества (строгий 3.0, мягкий 1.5)
Возвращает лучший интервал или дефолтное значение

# Как работает DINO детектор
1. Подготовка данных

Извлекает кадры из размеченных интервалов (позитивные примеры)
Создает негативные примеры из середины и конца видео
Применяет DINO processor для стандартизации изображений

2. Обучение классификатора

Использует предобученный DINO ViT-B/16 для извлечения признаков
Берет CLS токен (768 признаков) как представление кадра
Обучает MLP классификатор "заставка/не заставка"

3. Предсказание

Анализирует видео кадр за кадром с частотой 2 FPS
Применяет сглаживание скользящим окном
Ищет непрерывные участки высокой вероятности

4. Постобработка

Объединяет близко расположенные интервалы
Фильтрует слишком короткие участки
Выбирает самый длинный найденный интервал


